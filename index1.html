import os
import win32com.client

vba_file = r"C:\Users\Gaurav\Desktop\GauravPython\Module1.bas"
target_file = r"C:\Users\Gaurav\Desktop\GauravPython\new.xlsm"

# Create an instance of the Excel application
excel = win32com.client.Dispatch("Excel.Application")

# Open the target file
target_workbook = excel.Workbooks.Open(target_file)

# Add a new VBA module to the target workbook
vba_module = target_workbook.VBProject.VBComponents.Add(1)

# Read the VBA code from the .bas file
with open(vba_file, "r") as f:
    vba_code = f.read()

# Insert the VBA code into the new module
vba_module.CodeModule.AddFromString(vba_code)

# Save the target file with the new VBA code
target_workbook.Save()

# Close the target workbook
target_workbook.Close(SaveChanges=True)

# Quit the Excel application
excel.Quit()
