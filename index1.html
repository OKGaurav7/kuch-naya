def generate_output():
    # Read data from master.xlsx, Takara.xlsx, and prodman.xlsx
    master = pd.read_excel('master.xlsx')
    Takara = pd.read_excel('Takara.xlsx')
    prodman = pd.read_excel('prodman.xlsx')

    abc_df = pd.merge(master, Takara, left_on='Counterparty RDM Id', right_on='externalId', how='left')
    merged_output_df = pd.merge(abc_df, prodman, left_on='currentObligorRdmId', right_on='ObligorId', how='left')

    # Define selected columns
    selected_columns = ['Operation Type', 'Trade Date', 'Trade Price', 'Value Date', 'Primary Original Quantity', 'Settlement Instrument Name', 'ISIN Primary Instrument Reference', 'Primary Instrument Long Name', 'SMO Trade Reference', 'Internal Status Narrative', 'Sales Person Name','currentObligorRdmId', 'currentObligorFullName', 'CashScore']

    output_df = merged_output_df[selected_columns]
    output_df=output_df.drop_duplicates()
    new_columns = ['CBBT_PX_ASK', 'Economic Impact', 'LQA (Liq Score)', 'Days Elapsed']
    output_df.rename(columns={'currentObligorRdmId':'Obg Id', 'currentObligorFullName':'Client'},inplace=True)
    custom_column_order = ['Obg Id','Client', 'CashScore','Operation Type', 'Trade Date', 'Trade Price','CBBT_PX_ASK', 'Economic Impact', 'LQA (Liq Score)','Value Date','Days Elapsed','Primary Original Quantity', 'Settlement Instrument Name', 'ISIN Primary Instrument Reference', 'Primary Instrument Long Name', 'SMO Trade Reference', 'Internal Status Narrative', 'Sales Person Name']
    
    for i, col in enumerate(new_columns, start=1):
        output_df.insert(output_df.columns.get_loc('Obg Id') + i, col, '')

    output_df['Trade Date'] = pd.to_datetime(output_df['Trade Date']).dt.strftime('%Y-%m-%d')
    output_df['Value Date'] = pd.to_datetime(output_df['Value Date']).dt.strftime('%Y-%m-%d')

    # Apply thousand separators to "Primary Original Quantity"
    output_df['Primary Original Quantity'] = output_df['Primary Original Quantity'].apply(lambda x: "{:,}".format(x))

    # Remaining code...
